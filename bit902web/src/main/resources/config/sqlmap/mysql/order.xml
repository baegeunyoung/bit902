<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
 	"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="kr.co.smartpayweb.repository.mapper.OrderMapper">
	
<!-- 주문상태 resultMap -->
	<resultMap type="OrderVO" id="OrderStateMap">
		<result column="order_no" property="orderNo" />
		<result column="seller_no" property="sellerNo" />
		<result column="beacon_no" property="beaconNo" />
		<result column="table_no" property="tableNo" />
		<result column="order_date" property="orderDate" />
		<result column="order_content" property="orderContent" />
		<result column="device_token" property="deviceToken" />
		<result column="order_state" property="orderState" />
	</resultMap>
	
<!-- 주문상태 확인 -->
	<select id="retrieveOreder" parameterType="int" resultMap="OrderStateMap">
		select *
		  from tb_order o
		 inner join tb_beacon b
			on o.beacon_no = b.beacon_no
		 where o.seller_no = 2 and
			   year(o.order_date) = year(now()) and
			   month(o.order_date) = month(now()) and
			   dayofmonth(o.order_date) = dayofmonth(now()) and
			   (o.order_state = "0" or o.order_state = "1")
	</select>
</mapper>
